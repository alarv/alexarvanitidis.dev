#!/bin/sh
# Pre-commit hook: format staged files with Prettier

set -e

# Get staged files (added/copied/modified) and filter by extensions
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | \
  grep -E '\\.(ts|tsx|js|jsx|json|css|md|mdx|mjs|cjs)$' || true)

if [ -z "$STAGED_FILES" ]; then
  exit 0
fi

echo "Running Prettier on staged files..."

# Run Prettier on staged files using local binary
./node_modules/.bin/prettier --write $STAGED_FILES

# Re-stage any changes made by Prettier
echo "$STAGED_FILES" | xargs git add

echo "Prettier formatting complete."

exit 0

